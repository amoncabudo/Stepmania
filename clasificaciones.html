<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clasificaciones</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="src/CSS/style.css">
</head>
<body class="body-ranking">
    <header class="header">
        <a href="#" class="logo">ᚠ</a>
        <a href="index.html" class="home-button"><ion-icon name="home"></ion-icon></a>
    </header>

    <div class="titulo">
        <h1 class="titulo-clasificaciones">TABLA DE CLASIFICACIONES</h1>

    </div>

    <div class="tabla-clasificaciones">
    <table>
        <thead>
            <tr>
                <th>Posición</th>
                <th>Nombre</th>
                <th>Puntuación</th>
                <th>Fecha</th>

            </tr>
        </thead>
        <tbody id="rankingBody">
            <!-- Aquí se cargará dinámicamente el ranking -->
        </tbody>
    </table>
    </div>
    <script>
        async function loadRanking() {
            try {
                const response = await fetch('/src/PHP/puntuaciones.json');
                if (!response.ok) {
                    throw new Error('Error al cargar el archivo JSON');
                }

                const ranking = await response.json();
                const rankingBody = document.getElementById('rankingBody');
                ranking.sort((a, b) => b.score - a.score);

                const urlParams = new URLSearchParams(window.location.search);
                const currentPlayer = urlParams.get('nombre');
                const currentScore = parseInt(urlParams.get('puntuacion'));

                ranking.forEach((player, index) => {
                    const row = document.createElement('tr');

                    let rankingText;
                    if (index === 0) {
                        rankingText = `<span style="color: gold;">1</span>`; // Número 1 en oro
                    } else {
                        rankingText = index + 1;
                    }


                    row.innerHTML = `
                        <td>${rankingText}</td>
                        <td>${player.nombre}</td>
                        <td>${player.puntuacion}</td>
                        <td>${player.fecha}</td>

                    `;

                    if (player.name === currentPlayer && player.score === currentScore) {
                        row.classList.add('highlight');
                    }

                    rankingBody.appendChild(row);
                });

                if (ranking.length === 0) {
                    const noPlayersRow = document.createElement('tr');
                    noPlayersRow.innerHTML = `<td colspan="3">No hay jugadores en el ranking</td>`;
                    rankingBody.appendChild(noPlayersRow);
                }

            } catch (error) {
                console.error('Error al cargar el ranking:', error);
            }
        }
    
        document.addEventListener('DOMContentLoaded', () => {
            loadRanking();
            loadTopRanking();
        });
    </script>
    <script type="module" src="https://unpkg.com/ionicons@4.5.10-0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule="" src="https://unpkg.com/ionicons@4.5.10-0/dist/ionicons/ionicons.js"></script>

</body>
</html>
